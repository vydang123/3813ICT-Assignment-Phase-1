function cov_7naprfl2c(){var path="/Users/vydang/Desktop/3813ICT-Assignment-Phase-1/Assignment-1/server/routes/addChannel.js";var hash="9857ee845cbb7036489274e08fe913bd2b812a1d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/vydang/Desktop/3813ICT-Assignment-Phase-1/Assignment-1/server/routes/addChannel.js",statementMap:{"0":{start:{line:1,column:0},end:{line:49,column:2}},"1":{start:{line:2,column:2},end:{line:48,column:5}},"2":{start:{line:3,column:6},end:{line:47,column:7}},"3":{start:{line:5,column:10},end:{line:5,column:33}},"4":{start:{line:7,column:10},end:{line:9,column:11}},"5":{start:{line:8,column:14},end:{line:8,column:97}},"6":{start:{line:11,column:28},end:{line:11,column:46}},"7":{start:{line:12,column:26},end:{line:12,column:50}},"8":{start:{line:15,column:10},end:{line:17,column:11}},"9":{start:{line:16,column:14},end:{line:16,column:110}},"10":{start:{line:19,column:34},end:{line:19,column:64}},"11":{start:{line:22,column:32},end:{line:22,column:83}},"12":{start:{line:24,column:10},end:{line:26,column:11}},"13":{start:{line:25,column:14},end:{line:25,column:91}},"14":{start:{line:29,column:27},end:{line:29,column:55}},"15":{start:{line:30,column:10},end:{line:30,column:35}},"16":{start:{line:32,column:31},end:{line:35,column:11}},"17":{start:{line:37,column:10},end:{line:39,column:11}},"18":{start:{line:38,column:14},end:{line:38,column:105}},"19":{start:{line:41,column:10},end:{line:41,column:74}},"20":{start:{line:43,column:10},end:{line:43,column:53}},"21":{start:{line:44,column:10},end:{line:44,column:84}},"22":{start:{line:46,column:10},end:{line:46,column:25}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:1,column:17},end:{line:1,column:18}},loc:{start:{line:1,column:44},end:{line:49,column:1}},line:1},"1":{name:"(anonymous_1)",decl:{start:{line:2,column:26},end:{line:2,column:27}},loc:{start:{line:2,column:46},end:{line:48,column:3}},line:2}},branchMap:{"0":{loc:{start:{line:7,column:10},end:{line:9,column:11}},type:"if",locations:[{start:{line:7,column:10},end:{line:9,column:11}},{start:{line:7,column:10},end:{line:9,column:11}}],line:7},"1":{loc:{start:{line:15,column:10},end:{line:17,column:11}},type:"if",locations:[{start:{line:15,column:10},end:{line:17,column:11}},{start:{line:15,column:10},end:{line:17,column:11}}],line:15},"2":{loc:{start:{line:15,column:14},end:{line:15,column:36}},type:"binary-expr",locations:[{start:{line:15,column:14},end:{line:15,column:24}},{start:{line:15,column:28},end:{line:15,column:36}}],line:15},"3":{loc:{start:{line:24,column:10},end:{line:26,column:11}},type:"if",locations:[{start:{line:24,column:10},end:{line:26,column:11}},{start:{line:24,column:10},end:{line:26,column:11}}],line:24},"4":{loc:{start:{line:29,column:27},end:{line:29,column:55}},type:"binary-expr",locations:[{start:{line:29,column:27},end:{line:29,column:49}},{start:{line:29,column:53},end:{line:29,column:55}}],line:29},"5":{loc:{start:{line:37,column:10},end:{line:39,column:11}},type:"if",locations:[{start:{line:37,column:10},end:{line:39,column:11}},{start:{line:37,column:10},end:{line:39,column:11}}],line:37}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9857ee845cbb7036489274e08fe913bd2b812a1d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_7naprfl2c=function(){return actualCoverage;};}return actualCoverage;}cov_7naprfl2c();cov_7naprfl2c().s[0]++;module.exports=async(db,app,client)=>{cov_7naprfl2c().f[0]++;cov_7naprfl2c().s[1]++;app.post('/addChannel',async(req,res)=>{cov_7naprfl2c().f[1]++;cov_7naprfl2c().s[2]++;try{cov_7naprfl2c().s[3]++;// Connect to MongoDB
await client.connect();cov_7naprfl2c().s[4]++;if(!req.body){cov_7naprfl2c().b[0][0]++;cov_7naprfl2c().s[5]++;return res.status(400).send({success:false,message:'Request body is empty.'});}else{cov_7naprfl2c().b[0][1]++;}const groupName=(cov_7naprfl2c().s[6]++,req.body.groupName);const groupId=(cov_7naprfl2c().s[7]++,Number(req.body.groupId));//check to make sure groupName and groupID are received
cov_7naprfl2c().s[8]++;if((cov_7naprfl2c().b[2][0]++,!groupName)||(cov_7naprfl2c().b[2][1]++,!groupId)){cov_7naprfl2c().b[1][0]++;cov_7naprfl2c().s[9]++;return res.status(400).send({success:false,message:'groupName and groupId are required.'});}else{cov_7naprfl2c().b[1][1]++;}const groupCollection=(cov_7naprfl2c().s[10]++,db.collection('group-channel'));//find a group
const existingGroup=(cov_7naprfl2c().s[11]++,await groupCollection.findOne({groupid:groupId}));cov_7naprfl2c().s[12]++;if(!existingGroup){cov_7naprfl2c().b[3][0]++;cov_7naprfl2c().s[13]++;return res.status(400).send({success:false,message:'Group not found.'});}else{cov_7naprfl2c().b[3][1]++;}//add a channel to the group
const channels=(cov_7naprfl2c().s[14]++,(cov_7naprfl2c().b[4][0]++,existingGroup.channels)||(cov_7naprfl2c().b[4][1]++,[]));cov_7naprfl2c().s[15]++;channels.push(groupName);const updateResult=(cov_7naprfl2c().s[16]++,await groupCollection.updateOne({groupid:groupId},{$set:{channels:channels}}));cov_7naprfl2c().s[17]++;if(updateResult.modifiedCount===0){cov_7naprfl2c().b[5][0]++;cov_7naprfl2c().s[18]++;return res.status(500).send({success:false,message:'Error adding channel to group.'});}else{cov_7naprfl2c().b[5][1]++;}cov_7naprfl2c().s[19]++;res.send({success:true,message:'Channel added to group.'});}catch(err){cov_7naprfl2c().s[20]++;console.error('Error in addChannel:',err);cov_7naprfl2c().s[21]++;return res.status(500).send({success:false,message:'Server error.'});}finally{cov_7naprfl2c().s[22]++;client.close();}});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfN25hcHJmbDJjIiwiYWN0dWFsQ292ZXJhZ2UiLCJzIiwibW9kdWxlIiwiZXhwb3J0cyIsImRiIiwiYXBwIiwiY2xpZW50IiwiZiIsInBvc3QiLCJyZXEiLCJyZXMiLCJjb25uZWN0IiwiYm9keSIsImIiLCJzdGF0dXMiLCJzZW5kIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJncm91cE5hbWUiLCJncm91cElkIiwiTnVtYmVyIiwiZ3JvdXBDb2xsZWN0aW9uIiwiY29sbGVjdGlvbiIsImV4aXN0aW5nR3JvdXAiLCJmaW5kT25lIiwiZ3JvdXBpZCIsImNoYW5uZWxzIiwicHVzaCIsInVwZGF0ZVJlc3VsdCIsInVwZGF0ZU9uZSIsIiRzZXQiLCJtb2RpZmllZENvdW50IiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiY2xvc2UiXSwic291cmNlcyI6WyJhZGRDaGFubmVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKGRiLCBhcHAsIGNsaWVudCkgPT4ge1xuICBhcHAucG9zdCgnL2FkZENoYW5uZWwnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENvbm5lY3QgdG8gTW9uZ29EQlxuICAgICAgICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KCk7XG5cbiAgICAgICAgICBpZiAoIXJlcS5ib2R5KSB7XG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnUmVxdWVzdCBib2R5IGlzIGVtcHR5LicgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZ3JvdXBOYW1lID0gcmVxLmJvZHkuZ3JvdXBOYW1lO1xuICAgICAgICAgIGNvbnN0IGdyb3VwSWQgPSBOdW1iZXIocmVxLmJvZHkuZ3JvdXBJZCk7XG5cbiAgICAgICAgICAvL2NoZWNrIHRvIG1ha2Ugc3VyZSBncm91cE5hbWUgYW5kIGdyb3VwSUQgYXJlIHJlY2VpdmVkXG4gICAgICAgICAgaWYgKCFncm91cE5hbWUgfHwgIWdyb3VwSWQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdncm91cE5hbWUgYW5kIGdyb3VwSWQgYXJlIHJlcXVpcmVkLicgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZ3JvdXBDb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbignZ3JvdXAtY2hhbm5lbCcpO1xuXG4gICAgICAgICAgLy9maW5kIGEgZ3JvdXBcbiAgICAgICAgICBjb25zdCBleGlzdGluZ0dyb3VwID0gYXdhaXQgZ3JvdXBDb2xsZWN0aW9uLmZpbmRPbmUoeyBncm91cGlkOiBncm91cElkIH0pO1xuXG4gICAgICAgICAgaWYgKCFleGlzdGluZ0dyb3VwKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnR3JvdXAgbm90IGZvdW5kLicgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9hZGQgYSBjaGFubmVsIHRvIHRoZSBncm91cFxuICAgICAgICAgIGNvbnN0IGNoYW5uZWxzID0gZXhpc3RpbmdHcm91cC5jaGFubmVscyB8fCBbXTtcbiAgICAgICAgICBjaGFubmVscy5wdXNoKGdyb3VwTmFtZSk7XG5cbiAgICAgICAgICBjb25zdCB1cGRhdGVSZXN1bHQgPSBhd2FpdCBncm91cENvbGxlY3Rpb24udXBkYXRlT25lKFxuICAgICAgICAgICAgICB7IGdyb3VwaWQ6IGdyb3VwSWQgfSxcbiAgICAgICAgICAgICAgeyAkc2V0OiB7IGNoYW5uZWxzOiBjaGFubmVscyB9IH1cbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKHVwZGF0ZVJlc3VsdC5tb2RpZmllZENvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnRXJyb3IgYWRkaW5nIGNoYW5uZWwgdG8gZ3JvdXAuJyB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXMuc2VuZCh7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdDaGFubmVsIGFkZGVkIHRvIGdyb3VwLicgfSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBhZGRDaGFubmVsOicsIGVycik7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdTZXJ2ZXIgZXJyb3IuJyB9KTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgY2xpZW50LmNsb3NlKCk7XG4gICAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Im1rSEFlWTtBQUFBQSxhQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGFBQUEsR0FBQUEsYUFBQSxHQUFBRSxDQUFBLE1BZlpDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLE1BQU9DLEVBQUUsQ0FBRUMsR0FBRyxDQUFFQyxNQUFNLEdBQUssQ0FBQVAsYUFBQSxHQUFBUSxDQUFBLE1BQUFSLGFBQUEsR0FBQUUsQ0FBQSxNQUMxQ0ksR0FBRyxDQUFDRyxJQUFJLENBQUMsYUFBYSxDQUFFLE1BQU9DLEdBQUcsQ0FBRUMsR0FBRyxHQUFLLENBQUFYLGFBQUEsR0FBQVEsQ0FBQSxNQUFBUixhQUFBLEdBQUFFLENBQUEsTUFDeEMsR0FBSSxDQUFBRixhQUFBLEdBQUFFLENBQUEsTUFDRjtBQUNFLEtBQU0sQ0FBQUssTUFBTSxDQUFDSyxPQUFPLENBQUMsQ0FBQyxDQUFDWixhQUFBLEdBQUFFLENBQUEsTUFFdkIsR0FBSSxDQUFDUSxHQUFHLENBQUNHLElBQUksQ0FBRSxDQUFBYixhQUFBLEdBQUFjLENBQUEsU0FBQWQsYUFBQSxHQUFBRSxDQUFBLE1BQ1gsTUFBTyxD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