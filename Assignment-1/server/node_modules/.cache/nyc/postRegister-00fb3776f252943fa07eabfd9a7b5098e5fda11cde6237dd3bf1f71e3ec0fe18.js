function cov_3a3efmens(){var path="/Users/vydang/Desktop/3813ICT-Assignment-Phase-1/Assignment-1/server/routes/postRegister.js";var hash="6700b1f31bb0f56c9a04d99b1a2aa9dbafb950e5";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/vydang/Desktop/3813ICT-Assignment-Phase-1/Assignment-1/server/routes/postRegister.js",statementMap:{"0":{start:{line:1,column:0},end:{line:50,column:2}},"1":{start:{line:2,column:2},end:{line:49,column:5}},"2":{start:{line:4,column:4},end:{line:4,column:27}},"3":{start:{line:6,column:4},end:{line:8,column:5}},"4":{start:{line:7,column:6},end:{line:7,column:33}},"5":{start:{line:10,column:20},end:{line:10,column:28}},"6":{start:{line:11,column:19},end:{line:11,column:34}},"7":{start:{line:13,column:4},end:{line:48,column:5}},"8":{start:{line:14,column:29},end:{line:14,column:51}},"9":{start:{line:17,column:6},end:{line:21,column:7}},"10":{start:{line:18,column:22},end:{line:18,column:59}},"11":{start:{line:19,column:8},end:{line:19,column:27}},"12":{start:{line:20,column:8},end:{line:20,column:42}},"13":{start:{line:24,column:27},end:{line:24,column:81}},"14":{start:{line:25,column:6},end:{line:27,column:7}},"15":{start:{line:26,column:8},end:{line:26,column:88}},"16":{start:{line:30,column:31},end:{line:30,column:91}},"17":{start:{line:31,column:6},end:{line:33,column:7}},"18":{start:{line:32,column:8},end:{line:32,column:107}},"19":{start:{line:36,column:25},end:{line:36,column:62}},"20":{start:{line:37,column:6},end:{line:37,column:38}},"21":{start:{line:40,column:6},end:{line:40,column:46}},"22":{start:{line:42,column:6},end:{line:42,column:39}},"23":{start:{line:44,column:6},end:{line:44,column:51}},"24":{start:{line:45,column:6},end:{line:45,column:87}},"25":{start:{line:47,column:6},end:{line:47,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:1,column:17},end:{line:1,column:18}},loc:{start:{line:1,column:44},end:{line:50,column:1}},line:1},"1":{name:"(anonymous_1)",decl:{start:{line:2,column:24},end:{line:2,column:25}},loc:{start:{line:2,column:50},end:{line:49,column:3}},line:2}},branchMap:{"0":{loc:{start:{line:6,column:4},end:{line:8,column:5}},type:"if",locations:[{start:{line:6,column:4},end:{line:8,column:5}},{start:{line:6,column:4},end:{line:8,column:5}}],line:6},"1":{loc:{start:{line:17,column:6},end:{line:21,column:7}},type:"if",locations:[{start:{line:17,column:6},end:{line:21,column:7}},{start:{line:17,column:6},end:{line:21,column:7}}],line:17},"2":{loc:{start:{line:25,column:6},end:{line:27,column:7}},type:"if",locations:[{start:{line:25,column:6},end:{line:27,column:7}},{start:{line:25,column:6},end:{line:27,column:7}}],line:25},"3":{loc:{start:{line:31,column:6},end:{line:33,column:7}},type:"if",locations:[{start:{line:31,column:6},end:{line:33,column:7}},{start:{line:31,column:6},end:{line:33,column:7}}],line:31}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6700b1f31bb0f56c9a04d99b1a2aa9dbafb950e5"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_3a3efmens=function(){return actualCoverage;};}return actualCoverage;}cov_3a3efmens();cov_3a3efmens().s[0]++;module.exports=function(db,app,client){cov_3a3efmens().f[0]++;cov_3a3efmens().s[1]++;app.post('/register',async function(req,res){cov_3a3efmens().f[1]++;cov_3a3efmens().s[2]++;// Connect to the MongoDB client
await client.connect();cov_3a3efmens().s[3]++;if(!req.body){cov_3a3efmens().b[0][0]++;cov_3a3efmens().s[4]++;return res.sendStatus(400);}else{cov_3a3efmens().b[0][1]++;}const newUser=(cov_3a3efmens().s[5]++,req.body);const action=(cov_3a3efmens().s[6]++,req.body.action);cov_3a3efmens().s[7]++;try{const userCollection=(cov_3a3efmens().s[8]++,db.collection('users'));// Replace 'users' with your actual collection name
//activate action 'listUser' in super-admin page
cov_3a3efmens().s[9]++;if(action==='listUser'){cov_3a3efmens().b[1][0]++;const users=(cov_3a3efmens().s[10]++,await userCollection.find().toArray());cov_3a3efmens().s[11]++;console.log(users);cov_3a3efmens().s[12]++;return res.send({users:users});}else{cov_3a3efmens().b[1][1]++;}// Check if email already exists
const existingUser=(cov_3a3efmens().s[13]++,await userCollection.findOne({email:newUser.email}));cov_3a3efmens().s[14]++;if(existingUser){cov_3a3efmens().b[2][0]++;cov_3a3efmens().s[15]++;return res.status(400).send({valid:false,message:'Email already in use.'});}else{cov_3a3efmens().b[2][1]++;}// Check if username already exists
const existingUsername=(cov_3a3efmens().s[16]++,await userCollection.findOne({username:newUser.username}));cov_3a3efmens().s[17]++;if(existingUsername){cov_3a3efmens().b[3][0]++;cov_3a3efmens().s[18]++;return res.status(400).send({valid:false,message:'Username already exists. Choose another.'});}else{cov_3a3efmens().b[3][1]++;}// Assign new userID
const usersCount=(cov_3a3efmens().s[19]++,await userCollection.countDocuments());cov_3a3efmens().s[20]++;newUser.userid=usersCount+1;// Add new user to the MongoDB collection
cov_3a3efmens().s[21]++;await userCollection.insertOne(newUser);cov_3a3efmens().s[22]++;return res.send({valid:true});}catch(err){cov_3a3efmens().s[23]++;console.error('Error in postRegister:',err);cov_3a3efmens().s[24]++;return res.status(500).send({valid:false,message:'Error in registration.'});}finally{cov_3a3efmens().s[25]++;client.close();}});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfM2EzZWZtZW5zIiwiYWN0dWFsQ292ZXJhZ2UiLCJzIiwibW9kdWxlIiwiZXhwb3J0cyIsImRiIiwiYXBwIiwiY2xpZW50IiwiZiIsInBvc3QiLCJyZXEiLCJyZXMiLCJjb25uZWN0IiwiYm9keSIsImIiLCJzZW5kU3RhdHVzIiwibmV3VXNlciIsImFjdGlvbiIsInVzZXJDb2xsZWN0aW9uIiwiY29sbGVjdGlvbiIsInVzZXJzIiwiZmluZCIsInRvQXJyYXkiLCJjb25zb2xlIiwibG9nIiwic2VuZCIsImV4aXN0aW5nVXNlciIsImZpbmRPbmUiLCJlbWFpbCIsInN0YXR1cyIsInZhbGlkIiwibWVzc2FnZSIsImV4aXN0aW5nVXNlcm5hbWUiLCJ1c2VybmFtZSIsInVzZXJzQ291bnQiLCJjb3VudERvY3VtZW50cyIsInVzZXJpZCIsImluc2VydE9uZSIsImVyciIsImVycm9yIiwiY2xvc2UiXSwic291cmNlcyI6WyJwb3N0UmVnaXN0ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZGIsIGFwcCwgY2xpZW50KSB7XG4gIGFwcC5wb3N0KCcvcmVnaXN0ZXInLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICAvLyBDb25uZWN0IHRvIHRoZSBNb25nb0RCIGNsaWVudFxuICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KCk7XG5cbiAgICBpZiAoIXJlcS5ib2R5KSB7XG4gICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAwKTtcbiAgICB9XG5cbiAgICBjb25zdCBuZXdVc2VyID0gcmVxLmJvZHk7XG4gICAgY29uc3QgYWN0aW9uID0gcmVxLmJvZHkuYWN0aW9uO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJDb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbigndXNlcnMnKTsgLy8gUmVwbGFjZSAndXNlcnMnIHdpdGggeW91ciBhY3R1YWwgY29sbGVjdGlvbiBuYW1lXG4gICAgICBcbiAgICAgIC8vYWN0aXZhdGUgYWN0aW9uICdsaXN0VXNlcicgaW4gc3VwZXItYWRtaW4gcGFnZVxuICAgICAgaWYgKGFjdGlvbiA9PT0gJ2xpc3RVc2VyJykge1xuICAgICAgICBjb25zdCB1c2VycyA9IGF3YWl0IHVzZXJDb2xsZWN0aW9uLmZpbmQoKS50b0FycmF5KCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXJzKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kKHsgdXNlcnM6IHVzZXJzIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiBlbWFpbCBhbHJlYWR5IGV4aXN0c1xuICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgdXNlckNvbGxlY3Rpb24uZmluZE9uZSh7IGVtYWlsOiBuZXdVc2VyLmVtYWlsIH0pO1xuICAgICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoeyB2YWxpZDogZmFsc2UsIG1lc3NhZ2U6ICdFbWFpbCBhbHJlYWR5IGluIHVzZS4nIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiB1c2VybmFtZSBhbHJlYWR5IGV4aXN0c1xuICAgICAgY29uc3QgZXhpc3RpbmdVc2VybmFtZSA9IGF3YWl0IHVzZXJDb2xsZWN0aW9uLmZpbmRPbmUoeyB1c2VybmFtZTogbmV3VXNlci51c2VybmFtZSB9KTtcbiAgICAgIGlmIChleGlzdGluZ1VzZXJuYW1lKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IHZhbGlkOiBmYWxzZSwgbWVzc2FnZTogJ1VzZXJuYW1lIGFscmVhZHkgZXhpc3RzLiBDaG9vc2UgYW5vdGhlci4nIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBBc3NpZ24gbmV3IHVzZXJJRFxuICAgICAgY29uc3QgdXNlcnNDb3VudCA9IGF3YWl0IHVzZXJDb2xsZWN0aW9uLmNvdW50RG9jdW1lbnRzKCk7XG4gICAgICBuZXdVc2VyLnVzZXJpZCA9IHVzZXJzQ291bnQgKyAxO1xuXG4gICAgICAvLyBBZGQgbmV3IHVzZXIgdG8gdGhlIE1vbmdvREIgY29sbGVjdGlvblxuICAgICAgYXdhaXQgdXNlckNvbGxlY3Rpb24uaW5zZXJ0T25lKG5ld1VzZXIpO1xuXG4gICAgICByZXR1cm4gcmVzLnNlbmQoeyB2YWxpZDogdHJ1ZSB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHBvc3RSZWdpc3RlcjonLCBlcnIpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgdmFsaWQ6IGZhbHNlLCBtZXNzYWdlOiAnRXJyb3IgaW4gcmVnaXN0cmF0aW9uLicgfSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGNsaWVudC5jbG9zZSgpO1xuICAgIH1cbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiNnlHQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsYUFBQSxHQUFBQSxhQUFBLEdBQUFFLENBQUEsTUFmWkMsTUFBTSxDQUFDQyxPQUFPLENBQUcsU0FBVUMsRUFBRSxDQUFFQyxHQUFHLENBQUVDLE1BQU0sQ0FBRSxDQUFBUCxhQUFBLEdBQUFRLENBQUEsTUFBQVIsYUFBQSxHQUFBRSxDQUFBLE1BQzFDSSxHQUFHLENBQUNHLElBQUksQ0FBQyxXQUFXLENBQUUsZUFBZ0JDLEdBQUcsQ0FBRUMsR0FBRyxDQUFFLENBQUFYLGFBQUEsR0FBQVEsQ0FBQSxNQUFBUixhQUFBLEdBQUFFLENBQUEsTUFDOUM7QUFDQSxLQUFNLENBQUFLLE1BQU0sQ0FBQ0ssT0FBTyxDQUFDLENBQUMsQ0FBQ1osYUFBQSxHQUFBRSxDQUFBLE1BRXZCLEdBQUksQ0FBQ1EsR0FBRyxDQUFDRyxJQUFJLENBQUUsQ0FBQWIsYUFBQSxHQUFBYyxDQUFBLFNBQUFkLGFBQUEsR0FBQUUsQ0FBQSxNQUNiLE1BQU8sQ0FBQVMsR0FBRyxDQUFDSSxVQUFVLENBQUMsR0FBRyxDQUFDLENBQzVCLENBQUMsS0FB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